    <beans:bean id="ldapContextSource" class="org.springframework.security.ldap.DefaultSpringSecurityContextSource">
        <beans:constructor-arg value="${xa_ldap_url}"/>
        <!-- Set bind user values and uncomment below two lines, if your LDAP settings require this -->
        <!-- <beans:property name="userDn" value="***"/>
        <beans:property name="password" value="***"/> -->
        <!-- Uncomment the below line, if your LDAP settings require referral following -->
        <!-- <beans:property name="referral" value="follow"/> -->
    </beans:bean>
    <beans:bean id="ldapAuthProvider" class="org.springframework.security.ldap.authentication.LdapAuthenticationProvider">
        <beans:constructor-arg>
            <beans:bean class="org.springframework.security.ldap.authentication.BindAuthenticator">
                <beans:constructor-arg ref="ldapContextSource"/>
                <beans:property name="userDnPatterns">
                    <beans:list>
                        <beans:value>${xa_ldap_userDNpattern}</beans:value>
                    </beans:list>
                </beans:property>
            </beans:bean>
        </beans:constructor-arg>
        <beans:constructor-arg>
            <beans:bean class="org.springframework.security.ldap.userdetails.DefaultLdapAuthoritiesPopulator">
                <beans:constructor-arg ref="ldapContextSource"/>
                <beans:constructor-arg value="${xa_ldap_groupSearchBase}"/>
                <beans:property name="groupSearchFilter" value="${xa_ldap_groupSearchFilter}"/>
                <beans:property name="groupRoleAttribute" value="${xa_ldap_groupRoleAttribute}"/>
            </beans:bean>
        </beans:constructor-arg>
    </beans:bean>